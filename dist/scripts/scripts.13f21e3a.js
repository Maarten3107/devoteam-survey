"use strict";var angularApp=angular.module("angularjsFormBuilderApp",["ngRoute"]);angularApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/forms",{templateUrl:"views/forms.html",controller:"FormsCtrl"}).when("/survey/:id",{templateUrl:"views/survey/view.html",controller:"SurveyCtrl"}).when("/forms/create",{templateUrl:"views/create.html",controller:"CreateCtrl"}).when("/invite/:id",{templateUrl:"views/invite.html",controller:"InviteCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope",function(){}]),angularApp.controller("MainCtrl",["$scope","$http","$location",function(a,b,c){b.get("/api/forms").then(function(b){a.forms=b.data,console.log(b.data)},function(a){}),a.view=function(a){console.log("/survey/"+a._id),c.path("/survey/"+a._id)}}]),angularApp.controller("CreateCtrl",["$scope","FormService","$http","$location",function(a,b,c,d){a.previewMode=!0,a.form={},a.form.form_id=1,a.form.form_name="My Form",a.form.form_fields=[],a.previewForm={},a.addField={},a.addField.types=b.fields,a.addField["new"]=a.addField.types[0].name,a.addField.lastAddedID=0,a.accordion={},a.accordion.oneAtATime=!0,a.addNewField=function(){a.addField.lastAddedID++;var b={field_id:a.addField.lastAddedID,field_title:"New field - "+a.addField.lastAddedID,field_type:a.addField["new"],field_value:"",field_required:!0,field_disabled:!1};a.form.form_fields.push(b)},a.deleteField=function(b){for(var c=0;c<a.form.form_fields.length;c++)if(a.form.form_fields[c].field_id==b){a.form.form_fields.splice(c,1);break}},a.addOption=function(a){a.field_options||(a.field_options=new Array);var b=0;a.field_options[a.field_options.length-1]&&(b=a.field_options[a.field_options.length-1].option_id);var c=b+1,d={option_id:c,option_title:"Option "+c,option_value:c};a.field_options.push(d)},a.deleteOption=function(a,b){for(var c=0;c<a.field_options.length;c++)if(a.field_options[c].option_id==b.option_id){a.field_options.splice(c,1);break}},a.previewOn=function(){if(null==a.form.form_fields||0==a.form.form_fields.length);else a.previewMode=!a.previewMode,a.form.submitted=!1,angular.copy(a.form,a.previewForm)},a.previewOff=function(){a.previewMode=!a.previewMode,a.form.submitted=!1},a.showAddOptions=function(a){return"radio"==a.field_type||"dropdown"==a.field_type?!0:!1},a.submit=function(){var b=a.form;console.log(a.form),c.post("/api/forms",b).then(function(a){},function(a){alert("something went wrong")})},a.reset=function(){a.form.form_fields.splice(0,a.form.form_fields.length),a.addField.lastAddedID=0}}]),angularApp.controller("HeaderCtrl",["$scope","$location",function(a,b){a.$location=b}]);var InviteCtrl=angularApp.controller("InviteCtrl",["$scope","$http","FormService","$routeParams",function(a,b,c,d){a.form={},a.email="",a.emails={},a.notFound=!1;var e=d.id;a.getEmails=function(){b.get("/api/invites/"+e).then(function(b){a.emails=b.data,console.log(b.data)},function(a){alert("something went wrong")})},a.addEmail=function(){var c={form_id:e,email:a.email};b.post("/api/invites",c).then(function(a){},function(a){alert("Email could not be added")}),a.getEmails(),a.email=""},a.init=function(){a.getEmails(),c.form(e).then(function(b){a.form=b},function(){console.log("not found"),a.notFound=!0})}}]),SurveyCtrl=angularApp.controller("SurveyCtrl",["$scope","$http","FormService","$routeParams",function(a,b,c,d){a.form={},a.notFound=!1;var e=d.id;c.form(e).then(function(b){a.form=b},function(){console.log("not found"),a.notFound=!0})}]);angularApp.service("FormService",["$http",function(a){return{fields:[{name:"textfield",value:"Textfield"},{name:"email",value:"E-mail"},{name:"password",value:"Password"},{name:"radio",value:"Radio Buttons"},{name:"dropdown",value:"Dropdown List"},{name:"date",value:"Date"},{name:"textarea",value:"Text Area"},{name:"checkbox",value:"Checkbox"},{name:"hidden",value:"Hidden"}],form:function(b){return a.get("/api/forms/"+b).then(function(a){var b=a.data;return b})},forms:function(){return a.get("/api/forms").then(function(a){return a.data})}}}]),angularApp.directive("formDirective",function(){return{controller:["$scope",function(a){a.submit=function(){alert("Form submitted.."),a.form.submitted=!0},a.cancel=function(){alert("Form canceled..")}}],templateUrl:"./views/directive-templates/form/form.html",restrict:"E",scope:{form:"="}}});var __indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angularApp.directive("fieldDirective",["$http","$compile",function(a,b){var c=function(a){var b=a.field_type,c="./views/directive-templates/field/",d=["textfield","email","textarea","checkbox","date","dropdown","hidden","password","radio"];return __indexOf.call(d,b)>=0?c+=b+".html":void 0},d=function(d,e){var f=c(d.field);a.get(f).success(function(a){e.html(a),b(e.contents())(d)})};return{template:'<div ng-bind="field"></div>',restrict:"E",scope:{field:"="},link:d}}]),angular.module("angularjsFormBuilderApp").run(["$templateCache",function(a){a.put("views/create.html",'<div class="row"> <div class="col-xs-12 col-sm-6"> <h2>Create a new form</h2> <div class="form-fields" ng-hide=""> <div class="form-properties"> <div class="row"> <div class="col-sm-12"> <div class="form-group"> <label for="exampleInputEmail1">Form Name:</label> <input type="text" name="form-name" class="form-control" ng-model="form.form_name"> </div> <div class="form-group"> <label for="exampleInputEmail1">Form Description:</label> <textarea type="text" name="form-name" class="form-control" ng-model="form.form_description"></textarea> </div> <div class="form-group"> <label for="">Fields</label> <select class="form-control" ng-model="addField.new" ng-options="type.name as type.value for type in addField.types"></select> <br> </div> <div class="btn-toolbar" role="toolbar" aria-label="..."> <div class="btn-group" role="group" aria-label="..."> <button type="submit" class="btn" ng-click="addNewField()"><i class="icon-plus"></i> Add Field</button> </div> <div class="btn-group" role="group" aria-label="..."> <button class="btn btn-primary right" type="button" ng-click="previewOn()"><i class="icon-eye-open icon-white"></i> Preview Form</button> </div> <div class="btn-group" role="group" aria-label="..."> <button class="btn btn-success right" type="button" ng-disabled="" ng-click="submit()"><i class="icon-edit icon-white"></i> Save</button> </div> <div class="btn-group" role="group" aria-label="..."> <button class="btn btn-danger right" type="button" ng-click="reset()"><i class="icon-refresh icon-white"></i> Reset</button> </div> </div> </div> </div> </div> </div> <br> <p ng-show="form.form_fields.length == 0">No fields added yet.</p> <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"> <div class="panel panel-default" ng-repeat="field in form.form_fields"> <div class="panel-heading" role="tab" id="headingOne"> <h4 class="panel-title"> <a role="button" data-toggle="collapse" data-parent="#accordion" href="#{{field.field_id}}" aria-expanded="true" aria-controls="collapseOne"> {{field.field_title}} </a> </h4> </div> <div id="{{field.field_id}}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne"> <div class="panel-body"> <div class="accordion-edit"> <div class="row"> <div class="col-xs-12"> <button class="btn btn-danger pull-right" type="button" ng-click="deleteField(field.field_id)"><i class="icon-trash icon-white"></i> Delete</button> Field Type: {{field.field_type}} </div> </div> <div class="clear"></div> <hr> <div class="row"> <div class="col-xs-12"> <label>Field Title:</label> <input type="text" class="form-control" ng-model="field.field_title" value="{{field.field_title}}"> </div> </div> <div class="row"> <div class="col-xs-12"> <label>Field Default Value:</label> <input class="form-control" type="text" ng-model="field.field_value" value="{{field.field_value}}"> </div> </div> <div class="row" ng-show="showAddOptions(field)"> <div class="span2">Field Options:</div> <div class="span6"> <div ng-repeat="option in field.field_options"> <input type="text" ng-model="option.option_title" value="{{option.option_title}}"> <a class="btn btn-danger btn-mini right" type="button" ng-click="deleteOption(field, option)"><i class="icon-minus icon-white"></i></a> <span class="label label-inverse">Value: {{ option.option_value }}</span> </div> <button class="btn btn-primary btn-small" type="button" ng-click="addOption(field)"><i class="icon-plus icon-white"></i> Add Option</button> </div> </div> <div class="clear"></div> <hr> <div class="row"> <div class="col-xs-6"> <label>Required:</label> <label> <input type="radio" ng-value="true" ng-selected ng-model="field.field_required"> &nbsp; Yes </label> <label> <input type="radio" ng-value="false" ng-model="field.field_required"> &nbsp; No </label> </div> <div class="col-xs-6"> <label>Disabled:</label> <label> <input type="radio" ng-value="true" ng-selected ng-model="field.field_disabled"> &nbsp; Yes </label> <label> <input type="radio" ng-value="false" ng-model="field.field_disabled"> &nbsp; No </label> </div> </div> </div> </div> </div> </div> <div ng-show="showJson"> <h4>Form object content:</h4> <pre>{{ form | json }}</pre> </div> </div> </div> <div class="col-xs-12 col-sm-6"> <h2>Preview</h2> <div class="form-fields-preview"> <form-directive form="previewForm"></form-directive> </div> </div> </div> '),a.put("views/forms.html",""),a.put("views/invite.html",'<div class="invites" ng-controller="InviteCtrl" ng-init="init()"> <h1>Form: {{form.form_name}}</h1> <p>{{form.form_description}}</p> <div class="row"> <div class="col-xs-12"> <div class="pull-right"> <form class="form-inline"> <div class="form-group"> <input type="text" class="form-control" ng-model="email" placeholder="example@example.com"> </div> <button type="submit" class="btn btn-default" ng-click="addEmail()">Add email</button> </form> </div> </div> </div> <div class="row"> <div class="col-xs-12"> <div class="table-responsive"> <table class="table table-bordered"> <thead> <tr> <th>email</th> <th>status</th> <th>Actions</th> </tr> </thead> <tbody ng-repeat="invite in emails"> {{invite}} <tr> <td>{{invite.email}}</td> <td><span class="label label-warning">Pending</span></td> <td><button class="btn btn-danger btn-xs" disabled>remove</button> </td> </tr> </tbody> </table> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="table-responsive"> <table class="table table-bordered" ng-controller="MainCtrl"> <thead> <tr> <th>Name</th> <th>Description</th> <th>Actions</th> </tr> </thead> <tbody ng-repeat="form in forms"> <tr> <td>{{form.form_name}}</td> <td>{{form.form_description}}</td> <td><a href="/#/invite/{{form._id}}" class="btn btn-success btn-xs">Invite users</a> <button class="btn btn-success btn-xs" ng-click="view(form)">View Form</button> <button class="btn btn-warning btn-xs" disabled>edit</button> <button class="btn btn-danger btn-xs" disabled>remove</button> </td> </tr> </tbody> </table> </div>')}]);